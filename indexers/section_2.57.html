<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L2 Cache Controller (L2CC) | Microchip Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            overflow: hidden;
            width: 280px;
        }

        .nav-frame {
            width: 100%;
            height: 100%;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .main {
            margin-left: 280px;
            padding: 20px;
        }

        .nav-link {
            color: #333;
            padding: .5rem 1rem;
        }

        .nav-link.active {
            background-color: #f8f9fa;
            font-weight: 500;
        }

        .parameters-table {
            width: 100%;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="sidebar">
                <iframe class="nav-frame" src="navigation.html" title="Navigation"></iframe>
            </nav>
            <main class="main">
<div class="doc-navigation">
    <a href="section_2.html">↑ Up to Section</a><br />
    <a href="index.html">↑↑ Back to Main Documentation</a>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="section_2.html">API Documentation</a></li>
        <li class="breadcrumb-item active" aria-current="page">L2 Cache Controller (L2CC)</li>
    </ol>
</nav>

<h1>L2 Cache Controller (L2CC)</h1>
<h1>2.57</h1>
<p>L2 Cache Controller (L2CC)</p>
<p><em>Generated on: 2025-02-20 07:44:03</em></p>
<p>Source: <a href="https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-362A23BF-F3FB-4645-9439-90BD0BFBDFF7.html">https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-362A23BF-F3FB-4645-9439-90BD0BFBDFF7.html</a></p>
<h1><span id="2-57-l2-cache-controller-l2cc"></span>2.57 L2 Cache Controller (L2CC)</h1>
<p>The L2 Cache Controller (L2CC) is based on the L2CC-PL310 ARM multiway cache macrocell, version r3p2. The addition of an on-chip secondary cache, also referred to as a Level 2 or L2 cache, is a method of improving the system performance when significant memory traffic is generated by the processor.</p>
<h2><span id="using-the-library"></span>Using The Library</h2>
<p>The interface to L2 Cache operations is defined in the plib_l2cc.h header file. By definition a secondary cache assumes
the presence of a Level 1 or primary cache, closely coupled or internal to the processor. Memory access is fastest to L1 cache, followed closely by L2 cache.</p>
<p>Cache Coherency</p>
<p>Cache coherency is the discipline of ensuring that the data stored in main memory matches the corresponding data in the cache. The majority of the cache-related APIs deal with cache coherency. These functions allow the user to flush, clean and invalidate entire cache(s), or just a range of addresses within the cache.</p>
<p>Caches most often lose coherency when a bus master other than the CPU modifies memory. This happens frequently with DMA. Two examples are provided in the following section.</p>
<p>Example 1</p>
<p>Imagine a situation where you would like to transfer data from a source buffer to a destination buffer using DMA. You would write data to the source buffer, start the DMA transfer, and then expect that the same data now appears in the destination buffer. With the cache in write-back mode, this will not be the case. When transferring data out of memory using DMA, it is possible that the desired data is held in the cache, but has never been written back to main memory. Therefore, in this case, you write data to the source buffer and it gets stored in cache. When the DMA transfer executes, it will pull the data from the source buffer out of RAM and then transfer it to the destination buffer in RAM. The problem is that the fresh data was stored in the cache but never written back to RAM, so what has happened is that stale data was copied over rather than the intended data. What is needed is a way to force the cache to write its data back to main memory before the DMA transfer. This is known as a write-back operation and would be performed with the use of the function: DCACHE_CLEAN_BY_ADDR(addr,sz). This cleans L1 and L2 caches by invoking dcache_CleanByAddr(addr,sz) and PLIB_L2CC_CleanCacheByAddr(addr,sz) functions.</p>
<p>Example 2</p>
<p>The second situation involves writing data into memory using DMA. Imagine that the cache is holding a chunk of data known as destination_buffer. You then execute a DMA transfer to copy some new data from a source buffer into destination_buffer. The issue here is that main memory now contains the correct data, but the cache holds a copy of stale data for destination_buffer. The CPU cannot see this problem and it will keep pulling the data out of the cache, not even realizing that it’s stale. What is needed is a way to tell the cache to pull the fresh data out of main memory, to replace the stale data that the cache contains. This is known as an invalidate operation. It is performed with the use of the function: DCACHE_INVALIDATE_BY_ADDR(addr,sz). This invalidates L1 and L2 caches by invoking PLIB_L2CC_InvalidateCacheByAddr(addr,sz) and dcache_InvalidateByAddr(addr,sz) functions.</p>
<p>The example application, cache_maintenance, in the Cache PLIB Examples demonstrates this situation and shows how to resolve the issue.</p>
<h2><span id="library-interface"></span>Library Interface</h2>
<p>L2 Cache Controller peripheral library provides the following interfaces:</p>
<p>Functions</p>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PLIB_L2CC_Initialize</td>
<td>Initialize the L2 cache controller</td>
</tr>
<tr>
<td>PLIB_L2CC_CleanCache</td>
<td>Cleans (flushes) the L2 cache</td>
</tr>
<tr>
<td>PLIB_L2CC_InvalidateCache</td>
<td>Invalidates L2 cache entries</td>
</tr>
<tr>
<td>PLIB_L2CC_CleanInvalidateCache</td>
<td>Cleans and Invalidates L2 cache entries</td>
</tr>
<tr>
<td>PLIB_L2CC_InvalidateCacheByAddr</td>
<td>Invalidates L2 cache entries</td>
</tr>
<tr>
<td>PLIB_L2CC_CleanCacheByAddr</td>
<td>Flushes L2 cache entries</td>
</tr>
<tr>
<td>PLIB_L2CC_CleanInvalidateCacheByAddr</td>
<td>Cleans and Invalidates L2 cache entries</td>
</tr>
</tbody>
</table>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>