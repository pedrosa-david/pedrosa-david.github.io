<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I2CSMBx WriteRead Function | Microchip Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            overflow: hidden;
            width: 280px;
        }

        .nav-frame {
            width: 100%;
            height: 100%;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .main {
            margin-left: 280px;
            padding: 20px;
        }

        .nav-link {
            color: #333;
            padding: .5rem 1rem;
        }

        .nav-link.active {
            background-color: #f8f9fa;
            font-weight: 500;
        }

        .parameters-table {
            width: 100%;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="sidebar">
                <iframe class="nav-frame" src="navigation.html" title="Navigation"></iframe>
            </nav>
            <main class="main">
<div class="doc-navigation">
    <a href="section_2.105.html">↑ Up to Section</a><br />
    <a href="index.html">↑↑ Back to Main Documentation</a>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="section_2.html">API Documentation</a></li>
        <li class="breadcrumb-item"><a href="section_2.105.html">I2C SMBUS</a></li>
        <li class="breadcrumb-item active" aria-current="page">I2CSMBx WriteRead Function</li>
    </ol>
</nav>

<h1>I2CSMBx WriteRead Function</h1>
<h1>2.105.4</h1>
<p>I2CSMBx_WriteRead Function</p>
<p><em>Generated on: 2025-02-20 07:44:01</em></p>
<p>Source: <a href="https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-0A8B079C-1BDD-44A4-9A02-5831B22769AB.html">https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-0A8B079C-1BDD-44A4-9A02-5831B22769AB.html</a></p>
<h1><span id="2-105-4-i2csmbx-writeread-function"></span>2.105.4 I2CSMBx_WriteRead Function</h1>
<h2><span id="c"></span>C</h2>
<p>```C
/<em> x = I2C SMBUS peripheral instance number </em>/</p>
<p>bool I2CSMBx_WriteRead(uint16_t address, uint8_t<em> wdata, size_t wlength, uint8_t</em> rdata, size_t rlength)
```</p>
<h2><span id="summary"></span>Summary</h2>
<p>Write and Read data from I2C Slave.</p>
<h2><span id="description"></span>Description</h2>
<p>This function writes data from the wdata buffer to the slave of the given address and
                then reads data from the slave and stores the received in the rdata. The function
                generates a Start condition on the bus and will then send wlength number of bytes
                contained in wdata buffer. The function will then insert a Repeated start condition
                and proceed to read rlength number of bytes from the slave. The received bytes are
                stored in rdata buffer. A Stop condition is generated after the last byte has been
                received. If the slave NAKs the request or a bus error was encountered on the bus,
                the transfer is terminated. The application can call I2CSMBx_ErrorGet function to
                know the cause of the error. The function is non-blocking. It initiates the bus
                activity and returns immediately. The transfer is then completed in the peripheral
                interrupt. A transfer request cannot be placed when another transfer is in progress.
                Calling this function when another function is already in progress will cause the
                function to return false. The library will call the registered callback function
                when the transfer has completed.</p>
<h2><span id="precondition"></span>Precondition</h2>
<p>I2CSMBx_Initialize must have been called for the associated I2C instance.</p>
<h2><span id="parameters"></span>Parameters</h2>
<h3>Parameters</h3>
<table class="data-table">
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>address</td>
<td>7-bit / 10-bit slave address.</td>
</tr>
<tr>
<td>wdata</td>
<td>pointer to write data buffer</td>
</tr>
<tr>
<td>wlength</td>
<td>write data length in bytes.</td>
</tr>
<tr>
<td>rdata</td>
<td>pointer to read data buffer.</td>
</tr>
<tr>
<td>rlength</td>
<td>read data length in bytes.</td>
</tr>
</tbody>
</table>
<table class="data-table">
<thead>
<tr>
<th>Param</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>address</td>
<td>7-bit / 10-bit slave address.</td>
</tr>
<tr>
<td>wdata</td>
<td>pointer to write data buffer</td>
</tr>
<tr>
<td>wlength</td>
<td>write data length in bytes.</td>
</tr>
<tr>
<td>rdata</td>
<td>pointer to read data buffer.</td>
</tr>
<tr>
<td>rlength</td>
<td>read data length in bytes.</td>
</tr>
</tbody>
</table>
<h2><span id="returns"></span>Returns</h2>
<p>true - The request was placed successfully and the bus activity was
                initiated</p>
<p>false - The request fails, if there was already a transfer in progress when
                this function was called</p>
<h2><span id="example"></span>Example</h2>
<p>```C
uint8_t myTxData [NUM_BYTES] = {'1', '0', ' ', 'B', 'Y', 'T', 'E', 'S'};
uint8_t myRxData [NUM_BYTES] = {0};
void MyI2CCallback(uintptr_t context)
{
    // This function will be called when the transfer completes. Note
    // that this function executes in the context of the I2C interrupt.
}</p>
<p>I2CSMB0_CallbackRegister(MyI2CCallback, NULL);</p>
<p>if(!I2CSMB0_WriteRead( SLAVE_ADDR, &amp;myTxData[0], NUM_BYTES, myRxData, NUM_BYTES))
{
    // error handling
}
```</p>
<h2><span id="remarks"></span>Remarks</h2>
<p>Calling this function is not the same as calling the I2CSMBx_Write() function and
                then calling the I2CSMBx_Read() function. The I2CSMBx_WriteRead function will insert
                a Repeated Start condition between the Write and the Read stages. The
                I2CSMBx_Write() and the I2CSMBx_Read() function insert a stop condition after the
                write and the read has completed.</p>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>