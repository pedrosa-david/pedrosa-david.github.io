<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flash Write Control (FCW) | Microchip Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            overflow: hidden;
            width: 280px;
        }

        .nav-frame {
            width: 100%;
            height: 100%;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .main {
            margin-left: 280px;
            padding: 20px;
        }

        .nav-link {
            color: #333;
            padding: .5rem 1rem;
        }

        .nav-link.active {
            background-color: #f8f9fa;
            font-weight: 500;
        }

        .parameters-table {
            width: 100%;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="sidebar">
                <iframe class="nav-frame" src="navigation.html" title="Navigation"></iframe>
            </nav>
            <main class="main">
<div class="doc-navigation">
    <a href="section_2.html">↑ Up to Section</a><br />
    <a href="index.html">↑↑ Back to Main Documentation</a>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="section_2.html">API Documentation</a></li>
        <li class="breadcrumb-item active" aria-current="page">Flash Write Control (FCW)</li>
    </ol>
</nav>

<h1>Flash Write Control (FCW)</h1>
<h1>2.44</h1>
<p>Flash Write Control (FCW)</p>
<p><em>Generated on: 2025-02-20 07:44:03</em></p>
<p>Source: <a href="https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-D8A2C7C9-7D17-4CBE-A775-D9977F179EEB.html">https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-D8A2C7C9-7D17-4CBE-A775-D9977F179EEB.html</a></p>
<h1><span id="2-44-flash-write-control-fcw"></span>2.44 Flash Write Control (FCW)</h1>
<p>The FCW module provides interface to the device's Flash controller, so that memory pages can be written, read, erased in a standardized manner.</p>
<h2><span id="using-the-library"></span>Using The Library</h2>
<p>The main Flash memory can not be read while it is being erased or written, the CPU is stalled during the entire operation. All functions that modify the main Flash can be run from RAM memory to avoid CPU stall while main Flash is being erased or written.</p>
<p>FCW APIs are implemented to be non-blocking, the API will return immediately if not stalled by Flash operation. The user application can either poll the status or get callback once the flash operation is completed.</p>
<p>With polling, the application will need to continuously check if the flash operation is completed</p>
<p>With callback, the registered callback function will be called once the flash operation
            is completed. This means the application do not have to poll continuously. The interrupt
            must be enabled in MCC for callback method</p>
<p>Here is an example code to erase a page and program a row of memory using polling method</p>
<p>```C</p>
<h1>define APP_FLASH_ADDRESS  (FCW_FLASH_START_ADDRESS + (FCW_FLASH_SIZE / 2))</h1>
<p>uint8_t CACHE_ALIGN rowBuffer[FCW_FLASH_ROWSIZE] = {0};</p>
<p>void populate_buffer(uint8_t* data)
{
    int i = 0;</p>
<pre class="code-block"><code class="language-c">for (i = 0; i &lt; (FCW_FLASH_ROWSIZE); i++)
{
    *(data + i) = i;
}
</code></pre>
<p>}</p>
<p>int main (void)
{
    /<em>Populate rowBuffer to programmed</em>/
    populate_buffer(rowBuffer);</p>
<pre class="code-block"><code class="language-c">while(FCW_IsBusy());

/* Erase the page */
FCW_PageErase(APP_FLASH_ADDRESS);

/* Wait for page erase  to complete */
while(FCW_IsBusy());

/* Program a row of data */
FCW_RowWrite((uint32_t *)rowBuffer, APP_FLASH_ADDRESS);

/* Wait for row program to compete */
while(FCW_IsBusy());
</code></pre>
<p>}
```</p>
<ul>
<li>With polling, the application will need to continuously check if the flash operation is completed</li>
<li>With callback, the registered callback function will be called once the flash operation
            is completed. This means the application do not have to poll continuously. The interrupt
            must be enabled in MCC for callback method</li>
</ul>
<h2><span id="library-interface"></span>Library Interface</h2>
<p>Flash Write Control (FCW) peripheral library provides the following interfaces:</p>
<p>Functions</p>
<p>Data types and constants</p>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>FCW_Initialize</td>
<td>Initializes given instance of the FCW peripheral</td>
</tr>
<tr>
<td>FCW_Read</td>
<td>Reads length number of bytes from a given address in FLASH</td>
</tr>
<tr>
<td>memory</td>
<td></td>
</tr>
<tr>
<td>FCW_RowWrite</td>
<td>Writes one row of data to given FCW address</td>
</tr>
<tr>
<td>FCW_SingleDoubleWordWrite</td>
<td>Writes Two Words into the Flash</td>
</tr>
<tr>
<td>FCW_QuadDoubleWordWrite</td>
<td>Writes Eight Words into the Flash</td>
</tr>
<tr>
<td>FCW_PageErase</td>
<td>Erases a Page in the FCW</td>
</tr>
<tr>
<td>FCW_ErrorGet</td>
<td>Returns the error state of FCW controller</td>
</tr>
<tr>
<td>FCW_IsBusy</td>
<td>Returns the current status of FCW controller</td>
</tr>
<tr>
<td>FCW_CallbackRegister</td>
<td>Sets the pointer to the function (and it's context) to be called</td>
</tr>
<tr>
<td>when the operation is complete</td>
<td></td>
</tr>
<tr>
<td>FCW_ProgramFlashBankSelect</td>
<td>Selects program flash bank</td>
</tr>
<tr>
<td>FCW_ProgramFlashBankGet</td>
<td>Returns selected program flash bank</td>
</tr>
<tr>
<td>FCW_PFM_WriteProtectRegionSetup</td>
<td>Creates program flash region</td>
</tr>
<tr>
<td>FCW_PFM_WriteProtectEnable</td>
<td>Enable write protection for program flash</td>
</tr>
<tr>
<td>FCW_PFM_WriteProtectDisable</td>
<td>Disable write protection for program flash</td>
</tr>
<tr>
<td>FCW_PFM_WriteProtectLock</td>
<td>Disable Writes to Program Flash Write Protect Lock</td>
</tr>
<tr>
<td>register</td>
<td></td>
</tr>
<tr>
<td>FCW_BootFlashWriteProtectEnable</td>
<td>Enable write protection for boot flash</td>
</tr>
<tr>
<td>FCW_BootFlashWriteProtectDisable</td>
<td>Disable write protection for boot flash</td>
</tr>
<tr>
<td>FCW_BootFlashWriteProtectLock</td>
<td>Disable Writes to boot Flash Write Protect register</td>
</tr>
</tbody>
</table>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>FCW_ERROR</td>
<td>Enum</td>
<td>Defines the FCW Error Type</td>
</tr>
<tr>
<td>PROGRAM_FLASH_BANK</td>
<td>Enum</td>
<td>Defines program flash bank</td>
</tr>
<tr>
<td>BOOT_FLASH_BANK</td>
<td>Enum</td>
<td>Defines boot flash bank</td>
</tr>
<tr>
<td>FCW_BOOT_FLASH_WRITE_PROTECT</td>
<td>Enum</td>
<td>Defines boot flash write protect page</td>
</tr>
<tr>
<td>PFM_WP_REGION</td>
<td>Enum</td>
<td>Defines PFM write protect region</td>
</tr>
<tr>
<td>PFM_WP_REGION_SETUP</td>
<td>Struct</td>
<td>PFM write protect region Setup Structure</td>
</tr>
<tr>
<td>FCW_CALLBACK</td>
<td>Typedef</td>
<td>Defines the data type and function signature for the FCW</td>
</tr>
<tr>
<td>peripheral callback function</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>