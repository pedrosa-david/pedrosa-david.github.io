<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pulse Width Modulation Controller (PWM) | Microchip Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            overflow: hidden;
            width: 280px;
        }

        .nav-frame {
            width: 100%;
            height: 100%;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .main {
            margin-left: 280px;
            padding: 20px;
        }

        .nav-link {
            color: #333;
            padding: .5rem 1rem;
        }

        .nav-link.active {
            background-color: #f8f9fa;
            font-weight: 500;
        }

        .parameters-table {
            width: 100%;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="sidebar">
                <iframe class="nav-frame" src="navigation.html" title="Navigation"></iframe>
            </nav>
            <main class="main">
<div class="doc-navigation">
    <a href="section_3.31.html">↑ Up to Section</a><br />
    <a href="index.html">↑↑ Back to Main Documentation</a>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="section_3.html">Device Families</a></li>
        <li class="breadcrumb-item"><a href="section_3.31.html">SAM A7G5 Peripheral Libraries</a></li>
        <li class="breadcrumb-item active" aria-current="page">Pulse Width Modulation Controller (PWM)</li>
    </ol>
</nav>

<h1>Pulse Width Modulation Controller (PWM)</h1>
<h1>3.31.16</h1>
<p>Pulse Width Modulation Controller (PWM)</p>
<p><em>Generated on: 2025-02-19 08:42:44</em></p>
<p>Source: <a href="https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-5C4809F4-E25C-4051-8A95-21C2C4A9C9A4_3.html">https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-5C4809F4-E25C-4051-8A95-21C2C4A9C9A4_3.html</a></p>
<h1>3.31.16 Pulse Width Modulation Controller (PWM)</h1>
<p>The Pulse Width Modulation Controller (PWM) generates output pulses on four channels independently according to parameters defined per channel. Each channel controls two complementary square output waveforms. Characteristics of the output waveforms such as period, duty-cycle, polarity and dead-times are configured through the user interface. Each channel selects and uses one of the clocks provided by the clock generator. The clock generator provides several clocks resulting from the division of the PWM peripheral clock. External triggers can be managed to allow output pulses to be modified in real time.
Channels can be linked together as synchronous channels to be able to update their duty-cycle or dead-time at the same time.
The PWM provides eight independent comparison units capable of comparing a programmed value to the counter of the synchronous channels (counter of channel 0). These comparisons are intended to generate software interrupts, to trigger pulses on the two independent event lines (in order to synchronize ADC conversions with a lot of flexibility independently of the PWM outputs) and to trigger DMA Controller transfer requests.
The PWM provides a fault protection mechanism with eight fault inputs, capable to detect a fault condition and to override the PWM outputs asynchronously (outputs forced to ‘0’, ‘1’ or Hi-Z).</p>
<h2>Using The Library</h2>
<p>This example shows how to configure the PWM to generate three phase PWM signals with dead time for a motor control application. The duty cycle of the PWM is updated in the interrupt handler.</p>
<p>```C
/<em> Duty cycle increment value </em>/</p>
<h1>define DUTY_INCREMENT (10U)</h1>
<p>/<em> Save PWM period </em>/
uint16_t period;</p>
<p>/<em> This function is called after PWM0 counter event </em>/
void PWM_CounterEventHandler(uintptr_t context)
{
    static uint16_t duty0 = 0U;
    static uint16_t duty1 = 2500U;
    static uint16_t duty2 = 5000U;</p>
<pre class="code-block"><code class="language-c">PWMx_ChannelDutySet(PWM_CHANNEL_0, duty0);
PWMx_ChannelDutySet(PWM_CHANNEL_1, duty1);
PWMx_ChannelDutySet(PWM_CHANNEL_2, duty2);

/* Increment duty cycle values */
duty0 += DUTY_INCREMENT;
duty1 += DUTY_INCREMENT;
duty2 += DUTY_INCREMENT;

if (duty0 &gt; period)
    duty0 = 0U;
if (duty1 &gt; period)
    duty1 = 0U;
if (duty2 &gt; period)
    duty2 = 0U;
</code></pre>
<p>}</p>
<p>int main ( void )
{
    /<em> Register callback function for Channel 0 counter event </em>/
    PWMx_CallbackRegister(PWM_CounterEventHandler, (uintptr_t)NULL);</p>
<pre class="code-block"><code class="language-c">/* Read the period */
period = PWM0_ChannelPeriodGet(PWM_CHANNEL_0);

/* Start all synchronous channels by starting channel 0*/
PWMx_ChannelsStart(PWM_CHANNEL_0_MASK);
</code></pre>
<p>}
```</p>
<h2>Library Interface</h2>
<p>Pulse Width Modulation Controller peripheral library provides the following interfaces:</p>
<p>Functions</p>
<p>Data types and constants</p>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PWMx_Initialize</td>
<td>Initializes given instance of PWM peripheral</td>
</tr>
<tr>
<td>PWMx_ChannelsStart</td>
<td>Starts the given PWM channels</td>
</tr>
<tr>
<td>PWMx_ChannelsStop</td>
<td>Stops the given PWM channels</td>
</tr>
<tr>
<td>PWMx_ChannelPeriodSet</td>
<td>Sets the period value of given PWM channel</td>
</tr>
<tr>
<td>PWMx_ChannelPeriodGet</td>
<td>Reads the period value of given PWM channel</td>
</tr>
<tr>
<td>PWMx_ChannelDutySet</td>
<td>Writes the duty cycle value of given PWM channel</td>
</tr>
<tr>
<td>PWMx_ChannelDeadTimeSet</td>
<td>Writes dead time values of given PWM channel</td>
</tr>
<tr>
<td>PWMx_CompareValueSet</td>
<td>Writes the compare value for given PWM peripheral and given comparison unit</td>
</tr>
<tr>
<td>PWMx_ChannelCounterEventEnable</td>
<td>Enables counter event of given channels</td>
</tr>
<tr>
<td>PWMx_ChannelCounterEventDisable</td>
<td>Disables counter event of given channels</td>
</tr>
<tr>
<td>PWMx_ChannelCounterEventStatusGet</td>
<td>Disables counter event of given channels</td>
</tr>
<tr>
<td>PWMx_SyncUpdateEnable</td>
<td>This sets the synchronous update unlock bit</td>
</tr>
<tr>
<td>PWMx_FaultStatusClear</td>
<td>This function clears the status of the given fault id</td>
</tr>
<tr>
<td>PWMx_CallbackRegister</td>
<td>Registers the function to be called from interrupt</td>
</tr>
<tr>
<td>PWMx_ChannelOverrideEnable</td>
<td>This function overrides the PWM output</td>
</tr>
<tr>
<td>PWMx_ChannelOverrideDisable</td>
<td>This function select dead-time output as the PWM output</td>
</tr>
</tbody>
</table>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PWM_CALLBACK</td>
<td>Typedef</td>
<td>Defines the data type and function signature for the PWM peripheral callback function</td>
</tr>
<tr>
<td>PWM_CHANNEL_NUM</td>
<td>Enum</td>
<td>Identifies PWM channel number in a PWM peripheral</td>
</tr>
<tr>
<td>PWM_CHANNEL_MASK</td>
<td>Enum</td>
<td>Identifies PWM channel mask</td>
</tr>
<tr>
<td>PWM_COMPARE</td>
<td>Enum</td>
<td>Identifies PWM compare unit</td>
</tr>
<tr>
<td>PWM_FAULT_ID</td>
<td>Enum</td>
<td>Identifies PWM fault input ids</td>
</tr>
</tbody>
</table>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>