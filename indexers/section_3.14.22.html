<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timer(TMR) | Microchip Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            overflow: hidden;
            width: 280px;
        }

        .nav-frame {
            width: 100%;
            height: 100%;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .main {
            margin-left: 280px;
            padding: 20px;
        }

        .nav-link {
            color: #333;
            padding: .5rem 1rem;
        }

        .nav-link.active {
            background-color: #f8f9fa;
            font-weight: 500;
        }

        .parameters-table {
            width: 100%;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="sidebar">
                <iframe class="nav-frame" src="navigation.html" title="Navigation"></iframe>
            </nav>
            <main class="main">
<div class="doc-navigation">
    <a href="section_3.14.html">↑ Up to Section</a><br />
    <a href="index.html">↑↑ Back to Main Documentation</a>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="section_3.html">Device Families</a></li>
        <li class="breadcrumb-item"><a href="section_3.14.html">PIC32MK GPG MCJ Peripheral Libraries</a></li>
        <li class="breadcrumb-item active" aria-current="page">Timer(TMR)</li>
    </ol>
</nav>

<h1>Timer(TMR)</h1>
<h1>3.14.22</h1>
<p>Timer(TMR)</p>
<p><em>Generated on: 2025-02-19 08:42:44</em></p>
<p>Source: <a href="https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-3F3FF9DB-32EF-4C76-81A5-B58A2A54DB97_2.html">https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-3F3FF9DB-32EF-4C76-81A5-B58A2A54DB97_2.html</a></p>
<h1>3.14.22 Timer(TMR)</h1>
<p>Depending on the specific variant, the PIC32M device family offers several 16-bit timers. These timers are designated as Timer1, Timer2, Timer3, ..., etc.
Timers are useful for generating accurate time-based periodic interrupt events for software applications or real-time operating systems. Other uses include counting external pulses or accurate timing measurement of external events by using the timer's gate feature. With certain exceptions, all of the timers have the same functional circuitry.</p>
<p>The PIC32 has two kinds of timers:</p>
<p>Timer1</p>
<p>All timers can run when the Central Processing Unit (CPU) is in idle mode, but only Timer1's asynchronous external clock mode enables it to run while the CPU is in sleep. This, combined with its ability to be driven by a secondary oscillator, allows the timer to function as a real-time clock (RTC).</p>
<p>Timer2, 3, 4, etc ...</p>
<p>This peripheral library covers timers of this category.</p>
<p>Each timer has its own 16-bit counter and period registers. A 32-bit timer can be created by combining two timers (e.g. Timer2 &amp; Timer3). In this case, the 32-bit timer is controlled by the even number timer control registers (e.g. Timer2). When an interrupt event occurs, the odd number timer generates the event (e.g. Timer3). The timer supports the following features.
16-bit and 32-bit modes
Synchronous Internal Timer
Synchronous Internal Gated Timer
Synchronous External Timer</p>
<p>Timer Operation (non-gate mode)
When a timer is not in gate mode, it will generate an interrupt event when the value in the counter matches the value in the period register. When this match occurs, the counter is reset to zero, and the timer starts counting again. Note that if interrupts are disabled, the timer interrupt flag, TxIF, will still be set.</p>
<p>Timer Operation (Gate mode)
You can use the timer's gate feature to accurately measure the time for an external event. When the timers are in gate mode, the counters (driven by an internal clock) only increment when the TxCK pin is high. When this pin goes low, the timer stops incrementing and the timer interrupt flag, TxIF, is set. Note that in this mode, an interrupt event is not generated when the timer value matches the period register.</p>
<h2>Using The Library</h2>
<p>Timer mode is used for periodic interrupt generation. When the timer is enabled, it increments by one on every rising edge of the input clock, and generates an interrupt on a period match and the registered callback function will be called.</p>
<p>Callback method
This example demonstrates how to use the timer to generate periodic callback.</p>
<p>```C
/<em> This function is called after period expires </em>/
void TIMER2_EventHandler(uint32_t status, uintptr_t context)
{
    /<em> Toggle LED </em>/
    LED_Toggle();
}</p>
<p>int main(void)
{
    /<em> Register callback function Timer interrupt </em>/
    TMR2_CallbackRegister(TIMER2_EventHandler,(uintptr_t)NULL);</p>
<pre class="code-block"><code class="language-c">/* Start the timer channel 0*/
TMR2_Start();
</code></pre>
<p>}
```</p>
<h2>Library Interface</h2>
<p>peripheral library provides the following interfaces:</p>
<p>Functions</p>
<p>Data types and constants</p>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TMRx_Initialize</td>
<td>Initializes given instance of TMR</td>
</tr>
<tr>
<td>TMRx_Start</td>
<td>Starts the given Timer</td>
</tr>
<tr>
<td>TMRx_Stop</td>
<td>Stops the given Timer counter</td>
</tr>
<tr>
<td>TMRx_PeriodSet</td>
<td>Sets the period value of a given timer</td>
</tr>
<tr>
<td>TMRx_PeriodGet</td>
<td>Reads the period value of given timer</td>
</tr>
<tr>
<td>TMRx_CounterGet</td>
<td>Reads the timer counter value</td>
</tr>
<tr>
<td>TMRx_FrequencyGet</td>
<td>Provides the given timer's counter-increment frequency</td>
</tr>
<tr>
<td>TMRx_InterruptEnable</td>
<td>Enable TMR overflow interrupt</td>
</tr>
<tr>
<td>TMRx_InterruptDisable</td>
<td>Disable TMR overflow interrupt</td>
</tr>
<tr>
<td>TMRx_CallbackRegister</td>
<td>Sets the callback_fn function for an match</td>
</tr>
</tbody>
</table>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TMR_CALLBACK</td>
<td>Typedef</td>
<td>Defines the function pointer data type and function signature for the TMRx callback function</td>
</tr>
</tbody>
</table>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>