<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USARTx SPI TransferSetup Function | Microchip Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            overflow: hidden;
            width: 280px;
        }

        .nav-frame {
            width: 100%;
            height: 100%;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .main {
            margin-left: 280px;
            padding: 20px;
        }

        .nav-link {
            color: #333;
            padding: .5rem 1rem;
        }

        .nav-link.active {
            background-color: #f8f9fa;
            font-weight: 500;
        }

        .parameters-table {
            width: 100%;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="sidebar">
                <iframe class="nav-frame" src="navigation.html" title="Navigation"></iframe>
            </nav>
            <main class="main">
<div class="doc-navigation">
    <a href="section_2.124.html">↑ Up to Section</a><br />
    <a href="index.html">↑↑ Back to Main Documentation</a>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="section_2.html">API Documentation</a></li>
        <li class="breadcrumb-item"><a href="section_2.124.html">Universal Synchronous Asynchronous Receiver Transceiver (USART)</a></li>
        <li class="breadcrumb-item active" aria-current="page">USARTx SPI TransferSetup Function</li>
    </ol>
</nav>

<h1>USARTx SPI TransferSetup Function</h1>
<h1>2.124.27</h1>
<p>USARTx_SPI_TransferSetup Function</p>
<p><em>Generated on: 2025-02-20 07:44:01</em></p>
<p>Source: <a href="https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-9816E9DE-6EFF-4D1E-AFA2-5CA51807044C.html">https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-9816E9DE-6EFF-4D1E-AFA2-5CA51807044C.html</a></p>
<h1><span id="2-124-27-usartx-spi-transfersetup-function"></span>2.124.27 USARTx_SPI_TransferSetup Function</h1>
<h2><span id="c"></span>C</h2>
<p>```C
/<em> x = USART SPI instance number </em>/</p>
<p>/<em> USART SPI master mode </em>/
bool USARTx_SPI_TransferSetup(USART_SPI_TRANSFER_SETUP *setup, uint32_t spiSourceClock);
```</p>
<h2><span id="summary"></span>Summary</h2>
<p>Configure SPI operational parameters at run time.</p>
<h2><span id="description"></span>Description</h2>
<p>This function allows the application to change the SPI operational parameter at run time.
        The application can thus override the MCC defined configuration for these parameters. The
        parameter are specified via the USART_SPI_TRANSFER_SETUP type setup parameter. Each member
        of this parameter should be initialized to the desired value. The application may need to
        call this function in situation where multiple SPI slaves are connected on the sam SPI bus,
        each with different operation parameters. This function can thus be used to setup the SPI
        Master to meet the communication needs of the slave being talked to. Calling this function
        will affect any ongoing communication. The application must thus ensure that there is no
        on-going communication on the SPI before calling this function.</p>
<h2><span id="precondition"></span>Precondition</h2>
<p>SPI must first be initialized using USARTx_SPI_Initialize().</p>
<h2><span id="parameters"></span>Parameters</h2>
<h3>Parameters</h3>
<table class="data-table">
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>setup</td>
<td>Pointer to the data structure of type USART_SPI_TRANSFER_SETUP containing the operation parameters. Each operation parameter must be specified even if the parameter does not need to change.</td>
</tr>
<tr>
<td>spiSourceClock</td>
<td>SPI peripheral clock source frequency. If configured to 0, PLIB</td>
</tr>
<tr>
<td>takes the peripheral clock frequency from MCC.</td>
<td></td>
</tr>
</tbody>
</table>
<table class="data-table">
<thead>
<tr>
<th>Param</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>setup</td>
<td>Pointer to the data structure of type USART_SPI_TRANSFER_SETUP containing the operation parameters. Each operation parameter must be specified even if the parameter does not need to change.</td>
</tr>
<tr>
<td>spiSourceClock</td>
<td>SPI peripheral clock source frequency. If configured to 0, PLIB</td>
</tr>
<tr>
<td>takes the peripheral clock frequency from MCC.</td>
<td></td>
</tr>
</tbody>
</table>
<h2><span id="returns"></span>Returns</h2>
<p>true - setup was successful.</p>
<p>false - if spiSourceClock and SPI clock frequencies are such that resultant baud value is out of the possible range.</p>
<h2><span id="example"></span>Example</h2>
<p>```C
USART_SPI_TRANSFER_SETUP setup;
setup.clockFrequency = 1000000;
setup.clockPhase = USART_SPI_CLOCK_PHASE_TRAILING_EDGE;
setup.clockPolarity = USART_SPI_CLOCK_POLARITY_IDLE_LOW;
setup.dataBits = USART_SPI_DATA_BITS_8;</p>
<p>// Assuming 30 MHz as peripheral input clock frequency
if (USART1_SPI_TransferSetup (&amp;setup, 30000000) == false)
{
    // this means setup could not be done, debug the reason.
}
```</p>
<h2><span id="remarks"></span>Remarks</h2>
<p>The application would need to call this function only if the operational parameter need to
        be different than the ones configured in MCC.</p>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>