<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Clock (RTC) | Microchip Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            overflow: hidden;
            width: 280px;
        }

        .nav-frame {
            width: 100%;
            height: 100%;
            border: none;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .main {
            margin-left: 280px;
            padding: 20px;
        }

        .nav-link {
            color: #333;
            padding: .5rem 1rem;
        }

        .nav-link.active {
            background-color: #f8f9fa;
            font-weight: 500;
        }

        .parameters-table {
            width: 100%;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="sidebar">
                <iframe class="nav-frame" src="navigation.html" title="Navigation"></iframe>
            </nav>
            <main class="main">
<div class="doc-navigation">
    <a href="section_3.11.html">↑ Up to Section</a><br />
    <a href="index.html">↑↑ Back to Main Documentation</a>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item"><a href="section_3.html">Device Families</a></li>
        <li class="breadcrumb-item"><a href="section_3.11.html">PIC32CX MT Peripheral Libraries</a></li>
        <li class="breadcrumb-item active" aria-current="page">Real-time Clock (RTC)</li>
    </ol>
</nav>

<h1>Real-time Clock (RTC)</h1>
<h1>3.11.17</h1>
<p>Real-time Clock (RTC)</p>
<p><em>Generated on: 2025-02-19 08:42:43</em></p>
<p>Source: <a href="https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-A61C9610-86A7-45E0-B670-795D0CC5CAAF.html">https://onlinedocs.microchip.com/oxy/GUID-450989FA-38E4-4D68-AB61-15ADB29AD718-en-US-5/GUID-A61C9610-86A7-45E0-B670-795D0CC5CAAF.html</a></p>
<h1>3.11.17 Real-time Clock (RTC)</h1>
<p>The Real-time Clock (RTC) peripheral is designed for very low power consumption. For optimal functionality, the RTC
requires an accurate external 32.768 kHz clock, which can be provided by a crystal oscillator.</p>
<p>It combines a complete time-of-day clock with alarm and a Gregorian or Persian calendar, complemented by a
programmable periodic interrupt. The alarm and calendar registers are accessed by a 32-bit data bus.</p>
<p>The time and calendar values are coded in binary-coded decimal (BCD) format. The time format can be 24-hour
mode or 12-hour mode with an AM/PM indicator.</p>
<p>Updating time and calendar fields and configuring the alarm fields are performed by a parallel capture on the 32-bit
data bus. An entry control is performed to avoid loading registers with incompatible BCD format data or with an
incompatible date according to the current month/year/century.</p>
<p>A clock divider calibration circuitry can be used to compensate for crystal oscillator frequency variations.</p>
<p>Two RTC output can be programmed to generate several waveforms, including a prescaled clock derived from 32.768 kHz.</p>
<p>Timestamping capability reports the first and last occurrences for each tamper event detected on TMPx pins.</p>
<h2>Using The Library</h2>
<p>The RTC peripheral library supports Gregorian mode only hence all APIs implemented w.r.t Gregorian mode.</p>
<p>The RTC keeps track of the current time and generates an alarm at the desired time. The RTC Alarm has five programmable fields: month, day, hours, minutes, and seconds.</p>
<p>Each of these fields can be enabled or disabled individually to match the alarm condition:</p>
<p>If all the fields are enabled, an alarm flag is generated (the corresponding flag is asserted and an interrupt generated if enabled) at a given month, date, hour, minute, and second</p>
<p>If only the "seconds" field is enabled, then an alarm is generated every minute</p>
<p>Depending on the combination of fields enabled, a large number of possibilities are available to the user application ranging from minutes to 365/366 days.</p>
<p>To avoid unwanted side effects, verification is performed on century, year, month, day, hours, minutes and seconds when the user sets up the time and alarm. If any field fails its check, the new data is not loaded into the destination register (or counter) and returns a "false" status. When the user programs acceptable time/date fields, the time set and alarm set API returns "true".</p>
<p>This example demonstrates how to set the RTC time, and alarm time to
generate an alarm interrupt at the desired time of the day.</p>
<p>```C
void RTC_Callback( uintptr_t context, uint32_t int_cause )
{
    if (int_cause &amp; RTC_INT_ALARM)
    {
        /<em> Alarm has Occurred </em>/
    }
}</p>
<p>int main ( void )
{
    /<em> Initialize System Time and Alarm Time </em>/
    struct tm sys_time;
    struct tm alarm_time;</p>
<pre class="code-block"><code class="language-c">/* Register Callback */
RTC_CallbackRegister(RTC_Callback, (uintptr_t) NULL);

/* Set Time and date
  &lt;b&gt;15&amp;#45;01&amp;#45;2018 12:00:00 Monday&lt;/b&gt; */
sys_time.tm_hour = 12;
sys_time.tm_sec = 00;
sys_time.tm_min = 00;
sys_time.tm_mon = 0;
sys_time.tm_year = 118;
sys_time.tm_mday = 15;
sys_time.tm_wday = 1;

if (RTC_TimeSet(&amp;amp;sys_time) == false)
{
    // Invalid time and/or data input
}

/* Set Alarm Time and date. Generate alarm every day when Hour, Minute and Seconds match.
   &lt;b&gt;15&amp;#45;01&amp;#45;2018 12:00:20 Monday&lt;/b&gt; */
alarm_time.tm_hour = 12;
alarm_time.tm_sec = 20;
alarm_time.tm_min = 00;
alarm_time.tm_mon = 0;
alarm_time.tm_year = 118;
alarm_time.tm_mday = 15;
alarm_time.tm_wday = 1;

if (RTC_AlarmSet(&amp;amp;alarm_time, RTC_ALARM_MASK_HHMISS) == false)
{
    // Invalid Alarm Time and/or data input
}

/* Get System Time */
while ( true )
{
    RTC_TimeGet(&amp;amp;sys_time);
    printf("System time is:   %02d:%02d:%02d\\r",sys_time.tm_hour, sys_time.tm_min, sys_time.tm_sec);
}
</code></pre>
<p>}
```</p>
<ul>
<li>If all the fields are enabled, an alarm flag is generated (the corresponding flag is asserted and an interrupt generated if enabled) at a given month, date, hour, minute, and second</li>
<li>If only the "seconds" field is enabled, then an alarm is generated every minute</li>
</ul>
<h2>Library Interface</h2>
<p>Real-time Clock peripheral library provides the following interfaces:</p>
<p>Functions</p>
<p>Data types and constants</p>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>RTC_Initialize</td>
<td>Initializes given instance of the RTC peripheral</td>
</tr>
<tr>
<td>RTC_TimeSet</td>
<td>Sets the Time for the RTC peripheral</td>
</tr>
<tr>
<td>RTC_TimeGet</td>
<td>Reads the current time</td>
</tr>
<tr>
<td>RTC_AlarmSet</td>
<td>Sets up the Alarm</td>
</tr>
<tr>
<td>RTC_FirstTimeStampGet</td>
<td>Reads the timestamp for first occurrence of given tamper input</td>
</tr>
<tr>
<td>RTC_LastTimeStampGet</td>
<td>Reads the timestamp for last occurrence of given tamper input</td>
</tr>
<tr>
<td>RTC_InterruptDisable</td>
<td>Disables the specified RTC interrupt</td>
</tr>
<tr>
<td>RTC_InterruptEnable</td>
<td>Enables the specified RTC interrupt</td>
</tr>
<tr>
<td>RTC_CallbackRegister</td>
<td>Sets the pointer to the function (and it's context) to be called when the Timeout events occur</td>
</tr>
</tbody>
</table>
<table class="data-table">
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>RTC_ALARM_MASK</td>
<td>Enum</td>
<td>Defines the data type for the RTC Alarm Mask</td>
</tr>
<tr>
<td>RTC_INT_MASK</td>
<td>Enum</td>
<td>Defines the Interrupt mask for RTC events</td>
</tr>
<tr>
<td>RTC_TAMP_INPUT</td>
<td>Enum</td>
<td>Defines the Tamper input</td>
</tr>
<tr>
<td>RTC_CALLBACK</td>
<td>Typedef</td>
<td>Defines the data type and function signature for the RTC peripheral callback function</td>
</tr>
</tbody>
</table>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>